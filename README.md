# Arduino Environmental Monitoring System
![image](https://github.com/user-attachments/assets/5e36896a-f64f-475e-8132-ea60a5fb00e1)

Этот проект представляет собой систему мониторинга окружающей среды, использующую различные датчики для измерения температуры, влажности, давления и концентрации газа. Данные могут передаваться на мобильное устройство через Bluetooth. В данном разделе приводится описание кода и его функциональности.

## Описание

Код работает на платформе Arduino и использует следующие библиотеки:
- `dht.h` – для работы с датчиками температуры и влажности DHT22.
- `LiquidCrystal_I2C.h` – для управления LCD-дисплеем через интерфейс I2C.
- `Wire.h` – стандартная библиотека для работы с I2C.
- `Adafruit_BMP085.h` – для работы с барометром BMP085.
- `SoftwareSerial.h` – для общения с Bluetooth-модулем HC-05.

### Основные функции:

1. **Инициализация:**
   - В функции `setup()` происходит настройка последовательного порта для отслеживания данных через Serial Monitor и инициализация Bluetooth-соединения.
   - Настраиваются пины для различных устройств (датчиков, реле, кнопок).
   - Инициализируется LCD-дисплей и отображается начальное сообщение.
   - Проверяется наличие барометра BMP180/BMP085; если его нет, выводится сообщение об ошибке.

2. **Циклы чтения данных:**
   - В функции `loop()` осуществляется постоянное чтение данных с датчиков.
   - На основе текущего времени (используя функцию `millis()`) происходит проверка и чтение состояния датчиков на интервалах (каждые 2 секунды для сенсоров, каждые 200 мс для датчика газа).
   - Данные отправляются на Bluetooth-устройство каждые 3 секунды.

3. **Логирование данных:**
   - Данные о температуре, влажности, давлении и состоянии газа логируются в строковом формате, что позволяет отслеживать состояние системы через Serial Monitor.

4. **Технологии и компоненты:**
   - **Датчик температуры и влажности DHT22** – для измерения температуры и влажности воздуха.
   - **Барометр BMP180/BMP085** – для измерения давления и высоты.
   - **MQ-2 (или другой подобный датчик)** – для определения концентрации газа.
   - **Bluetooth модуль HC-05** – для передачи данных на мобильные устройства.
   - **LCD-дисплей** – для отображения текущих данных.
Более детальный обзор функций

### 1. `setup()`

Эта функция выполняется один раз в начале программы. Она инициализирует аппаратные и программные компоненты системы:

* **`Serial.begin(9600);`**: Инициализирует последовательный порт связи со скоростью передачи данных 9600 бод. Это позволяет отслеживать работу системы через монитор последовательного порта Arduino.
* **`bluetoothSerial.begin(9600);`**: Инициализирует последовательный порт связи Bluetooth (с помощью библиотеки `SoftwareSerial`) со скоростью 9600 бод. Это устанавливает связь с Bluetooth-модулем HC-05.
* **`pinMode(...)`**: Настраивает входные/выходные порты. Конкретные порты устанавливаются для аналогового датчика газа (`MQ2_ANA_PIN`), цифрового датчика газа (`MQ2_DIG_PIN`), светодиодного индикатора газа (`LED_GAS_PIN`), звукового сигнализатора (`BUZZER_PIN`), кнопки (`BUTTON_PIN`) и управления питанием DHT22 (`DHT_POWER_PIN`).
* **`lcd.init(); lcd.backlight(); lcd.clear();`**: Инициализирует ЖК-дисплей I2C, включает подсветку и очищает экран.
* **`lcd.print(...)`**: Выводит начальные сообщения ("Система запускается...", "Режим Bluetooth") на ЖК-дисплей.
* **`if (!bmp180.begin()) { ... }`**: Проверяет наличие подключения барометра BMP180/BMP085. Если его нет, выводится сообщение об ошибке как в монитор последовательного порта, так и на ЖК-дисплей, и программа останавливается.
* **`read_sensors_data();`**: Считывает начальные данные с датчиков. Это заполняет начальные значения для температуры, влажности и т.д.
* **`update_lcd();`**: Обновляет ЖК-дисплей начальными показаниями датчиков.


### 2. `loop()`

Эта функция повторяется после завершения `setup()`. Она образует основной цикл управления программы:

* **`unsigned long current_millis = millis();`**: Получает текущее время в миллисекундах с момента запуска Arduino.
* **`handle_button();`
* **`if (current_millis - previous_millis_sensors >= sensor_interval) { ... }`**: Проверяет, прошло ли достаточно времени с момента последнего считывания данных с датчиков (определяется `sensor_interval`, который равен 2000 миллисекундам или 2 секундам). Если да:
    * **`read_sensors_data();`**: Считывает данные с датчиков температуры, влажности и давления.
    * **`update_min_max();`**: Обновляет минимальные и максимальные значения для температуры и влажности.
    * **`update_lcd();`**: Обновляет ЖК-дисплей новыми показаниями.
    * **`log_to_serial();`**: Отправляет данные датчиков в монитор последовательного порта.
* **`if (current_millis - previous_millis_gas >= gas_interval) { ... }`**: Проверяет, прошло ли достаточно времени с момента последнего считывания данных с датчика газа (`gas_interval` равен 200 миллисекундам). Если да:
    * **`check_gas_sensor();`**: Считывает и обрабатывает данные с датчика газа. Вероятно, это включает проверку утечек газа и срабатывание тревог (звуковой сигнализатор, светодиод).
* **`if (current_millis - previous_millis_bt_send >= bt_send_interval) { ... }`**: Проверяет, прошло ли достаточно времени с момента последней передачи данных по Bluetooth (`bt_send_interval` равен 3000 миллисекундам или 3 секундам). Если да:
    * **`send_data_to_bluetooth();`**: Отправляет данные датчиков на подключенное Bluetooth-устройство.


### 3. `log_data()`

Эта функция форматирует и отправляет данные датчиков в монитор последовательного порта для отладки и ведения журнала. Она создает отформатированную строку, содержащую температуру, влажность, давление, высоту, значение датчика газа и состояние газа ("OK" или "ALERT"). Эта строка затем выводится с помощью `Serial.println()`.


### 4. `send_data_to_bluetooth()`

Эта функция отвечает за передачу данных датчиков на подключенное Bluetooth-устройство, она форматирует данные в подходящий формат передачи (например, JSON) и отправляет их через последовательное соединение Bluetooth (`bluetoothSerial`).


### 5. `read_sensors_data()`, `update_min_max()`, `update_lcd()`, `check_gas_sensor()`, `handle_button()`



* **`read_sensors_data()`**: Считывает данные со всех датчиков (DHT22, BMP085, MQ2).
* **`update_min_max()`**: Обновляет минимальные и максимальные записанные значения для температуры и влажности.
* **`update_lcd()`**: Обновляет информацию, отображаемую на ЖК-экране.
* **`check_gas_sensor()`**: Считывает данные с датчика газа (MQ2), проверяет на опасные уровни и активирует соответствующие реакции (например, звуковой сигнализатор, светодиод).
* **`handle_button()`**: Управляет любыми действиями, вызванными нажатием кнопки (не полностью описано).



## Использование

1. Подключите все компоненты согласно схемам.
2. Загрузите код на плату Arduino.
3. Откройте Serial Monitor для проверки данных или используйте Bluetooth для отправки данных на мобильное устройство.
4. Вы можете настроить различные пороги для уведомлений, например, для состояния газа, изменив соответствующие переменные в коде.

## Важно

Перед использованием убедитесь, что все компоненты подключены корректно и что у вас установлены необходимые библиотеки. Ознакомьтесь с документацией на компонент для более подробной информации по его настройке и использования.

## Заключение

Этот проект демонстрирует, как можно использовать Arduino для мониторинга окружающей среды.
Для вопросов и предложений, пожалуйста, обращайтесь в разделе Issues на репозитории.
## Задание выполнили 
Мешакшин Егор Судиловский Валерий Шарапова Анна 



